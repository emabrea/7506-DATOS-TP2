\documentclass[a4paper ,12pt]{article}
\usepackage[colorlinks=true,linkcolor=black,urlcolor=blue,bookmarksopen=true]{hyperref}
\usepackage{bookmark}
\usepackage{fancyhdr} %Libreria para encabezado y pie de página.
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{ {graficos/} }

\usepackage{float}

\pagestyle{fancy} % Encabezado y pie de página
\fancyhf{}
\fancyhead[L]{TP2 - Grupo 25}
\fancyhead[R]{75.06 - Organización de Datos}
\renewcommand{\headrulewidth}{0.4pt}
\fancyfoot[C]{\thepage}
\renewcommand{\footrulewidth}{0.4pt}

\begin{document}
\tableofcontents % Índice general
\newpage

\section{Procesamiento y análisis de datos}\label{sec:intro}

En esta sección se introduce brevemente el producto a analizar y las herramientas que se utilizaron para realizar el análisis y la predicción requerida.



\subsection{Datos utilizados}

Se estudiaron datos provistos por la empresa Trocafone, analizando un conjunto de eventos de web analytics de usuarios que visitaron \url{www.trocafone.com}, su plataforma de e-commerce de Brasil.

\subsection{Sobre la empresa}

 
Trocafone es un side to side Marketplace para la compra y venta de dispositivos electrónicos que se encuentra actualmente operando en Brasil y Argentina. \\


La empresa realiza distintas actividades que van desde la implementación de plataformas de trade-in (conocidos en la Argentina como Plan Canje), logística directa y reversa, reparación y recertificación de dispositivos (refurbishing) y venta de productos recertificados por múltiples canales (ecommerce, marketplace y tiendas físicas).\\ 


Para conocer más de su modelo de negocio, pueden visitar el siguiente artículo:

\url{ https://medium.com/trocafone/el-maravilloso-mundo-de-trocafone-5bdc5761856b}

\subsection{Lenguajes y librerías utilizados}

\begin{itemize}
	
	\item Se utlizó como lenguaje de programación \textbf{Python3}.
	
	\item Para las visualizaciones, se utilizaron las librerías \textbf{ MatPlotLib }y\textbf{ Seaborn}.
	
	\item Como editor se utilizó \textbf{Jupyter Lab} (o \textbf{Jupyter Notebook})
	
	\item Para el manejo de DataFrames, se eligió \textbf{Pandas} como librería a utilizar.

	\item Se utilizaron algunas herramientas como std o argsort de la librería \textbf{Numpy}.
	calendar
	
	\item Se importaron diferentes métricas como "accuracy score", "f1 score", "precision score", "recall score", "roc auc score" de la librería \textbf{sklearn}.
	
	\item Se utilizaron diferentes busquedas de hiperparametros, entre ellas  "GridSearch" y "RandomizedSearchCV"  de \textbf{sklearn}.
	
	\item Para poder realizar cross-validation, se importó "StratifiedKFold" de \textbf{sklearn}.

	\item Se realizó Clustering mediante la funcion "KMeans" de la librería \textbf{sklearn}.
	
	\item Los siguientes clasificadores fueron importados: 	"xgboost", "lightgbm", "RandomForestClassifier", "CatBoostClassifier".
	
	\item Se utilizo como ensamble de clasificadores a "VotingClassifier".
	
\end{itemize}

\subsection{Repositorio de Github}

Para el trabajo en conjunto del equipo, se utilizo un repositorio en github, donde se encuentran todos los archivos necesarios del análisis y predicciones y este informe propiamente dicho.\\

Link: \url{https://github.com/emabrea/7506-DATOS-TP2.git}

\newpage
\section{Breve análisis del set de Datos}





\newpage
\section{Featuring Engineering segunda entrega (Train 100\%)}

\subsection{ Features sobre acciones por rango de tiempo }

		
		\subsubsection{Acciones en el último mes}
	
		\begin{itemize}
		 	
		\item Visitas último mes
		
		\item Checkouts último mes
		
		\item Compras último mes
		
		\item Subscripciones último mes
		\end{itemize}
		
	
		

		\subsubsection{Acciones en los últimos 15 días}		
		
		\begin{itemize}
			\item 	Visitas últimos 15
		\end{itemize}
		


		\subsubsection{Acciones en la última semana}
			
			\begin{itemize}
				\item  Visitas última semana
				\item  Checkouts última semana
				\item  Compras última semana 
				\item Campaña ultima semana
			\end{itemize}
			

		\subsubsection{Acciones en los últimos 3 días}
		
		
		
			\begin{itemize}
				\item Visitas últimos 3
			\end{itemize}





\subsection{Features de acciones del usuario}

	\begin{itemize}
		\item Total visitas usuario
		
		\item Total checkout
		
		\item Total compras
		
		\item Búsqueda celular 
		
		\item Días distintos 
		
		\item última visita 
		
	\end{itemize}
	


\subsection{Features de modelos}

	\begin{itemize}
		
		\item Modelos distintos vistos
			
	\end{itemize}	

\newpage
\section{Clasificadores}

\newpage
\section{Tuning}

Grid Search y Random Search en KNN

En los diferentes algoritmos vamos a llamar parámetros a aquellos valores que el algo-
ritmo encuentra a partir de los datos y vamos a llamar hiper-parámetros a
aquellos datos que el algoritmo necesita para poder funcionar.

Llamaremos óptimos a los hiper-parámetros que logren para un set de Datos maximizar determinada métrica, en este caso, utilizamos la métrica ROC AUC.\

Para encontrar los hiper-parámetros óptimos para un algoritmo pueden usarse dos métodos: Grid-Search o Random-Search.\\

\subsection{Grid-Search}

En un Grid-Search probamos todas las combinaciones posibles dentro de una lista de valores posibles para cada hiper-parámetro.

En este caso, debido a la cantidad de hiper-parámetros , se decidió comenzar en las listas de valores posibles para cada uno con un ”paso” grueso.

Esto reduce en un principio la cantidad de combinaciones a ejecutar. Luego se podra refinar la busqueda en la zona donde resultaron optimos nuestros hiper-parametros iniciales.

Este proceso fue especialmente necesario cuando los hiper-parámetros tomaban valores reales.

Cuando la cantidad de hiper-parámetros es realmente muy grande la combinatoria a realizar puede resultar muy ineficiente, en estos casos puede re-
currirse al método de Random-Search.

\subsection{Random-Search}

Como la cantidad de hiperparametros era elevada, posteriormente se recurrió al método de Random-Search,

En este método controlamos cuantas iteraciones realizamos de nuestro algoritmo y por cada iteración seleccionamos los valores de los
hiper-parámetros al azar dentro de un rango preestablecido. 

Cabe aclarar que este método no es tan preciso como un grid-search pero es mucho mas rápido, pudiendo invertir mayor parte del tiempo a la creación de Features.

\subsection{Aplicación a nuestro algoritmo}

En uno de nuestros primeros ensambles (constituídos por un Random Forest y un XGBoost) se aplico el método de Random Search con el fin de poder encontrar (u obtener una buena aproximacióń a ellos) de los hiperparametros:\\

\underline{Para XGBoost: }

\begin{itemize}
	\item Peso de
\end{itemize}



\underline{Para Random Forest:}

\begin{itemize}
	
	\item Peso de una de las clase 1 : La lista de este hiperparametro contenía los números del 1 al 10
	
	\item Criterio: Este hiper-parámetro podía ser : \{'gini', 'entropy'\}

\end{itemize}


Es muy importante aclarar que para la validación de hiper-parámetros se utilizó K-fold cross validation, con K= 10.

Es decir, de nuestro set de datos, el 10\% fue usado para validar los hiperparametros cada vez.


\newpage
\section{Ensamble}

Los mejores algoritmos de ML suelen surgir de la combinación de varios algo-
ritmos. Es muy raro que un solo algoritmo de ML logre mejores resultados que
un ensamble. Esto pudo verse en las sucesivas entregas, donde utilizar un ensamble nos traía
resultados mas satisfactorios que usar los algoritmos en soledad.

\subsection{Combinando Algoritmos Diferentes}

Estos procesos suelen ser la clave para obtener un mejor resultado, ya que permitieron aprovechar el poder expresivo
de varios modelos completamente diferentes para obtener un resultado común.
En nuestro caso, el problema a abordar era de clasificación.

\subsubsection{Majority Voting}

Tenemos varios clasificadores distintos para un cierto problema, cada uno de ellos produce un resultado y queremos obtener un 
 resultado final. Una aproximación simple es ver cual es la clase que tiene mayoría entre todos los clasificadores.

En un primer momento, se decidió utilizar este tipo de ensamble debido a su simplicidad, 
pero nos encontramos que el mismo tiene sentido cuando la predicción es directamente la clase.
Si la predicción es la probabilidad de cada clase entonces obtuvimos que otros métodos funcionan mejor. 

Cuando la correlación entre los modelos es baja el resultado del ensamble, en general, mejora notablemente el resultado de cada modelo individual. 
\\

Una primera conclusión es que dados muchos clasificadores es conveniente elegir un conjunto que tenga buenos resultados y que estén muy poco correlacionados.

\subsubsection{Averaging}

Promediar el resultado de varios clasificadores es un método muy popular que
funciona en muchos problemas distintos: regresión, clasificación (ya sea para
predecir clases o probabilidades), etc. La idea principal es reducir el overfitting.

En general, una separación suave entre las clases es mejor que una separación
muy irregular y promediar clasificadores logra esto.

Cuando promediamos clasificadores que predicen la probabilidad de las clases, hubo
que prestar especial atención porque cada clasificador individual puede tener una calibración completamente diferente. 

Uno puede dar probabilidades muy cercanas a 1s y 0s mientras que otro, a lo mejor, se mantiene dentro de un cierto rango.
Una solución para esto es convertir cada probabilidad de un rango entre 1 y n, siendo n el total de personas a predecir. La persona con mayor probabilidad tiene 1,
el segundo 2, etc, y el de menor probabilidad, n, sin importar el valor de las probabilidades. Si hacemos esto para todos los clasificadores podemos luego
promediar los rangos y convertir estos promedios en un número entre 0 y 1 para la probabilidad final.


\newpage
\section{Conclusiones generales}

Al finalizar el presente trabajo, nos propusimos destacar ciertos aspectos del mismo, de tal modo que permitan a la empresa tener una visión más clara de su progreso.\\


\underline{Los principales puntos a tratar son}:

\begin{itemize}
	
\item Las ventas de celulares vienen aumentando con los meses, pero lentamente, aproximadamente 50 ventas más por mes.

\item Las campañas y avisos publicitarios deben publicarse durante la semana, y no en el fin de semana.
Además, dichas campañas deben mostrarse a partir de las 16:00, recordando que la mayor actividad ocurre a la noche.

\item El día martes es un buen candidato para publicitar, tal vez porque los lunes son muy cargados de trabajo, y recién el martes uno tiene más libertad.

\item Continuar con la campaña de subscripciones, luego de realizar una compra, pues en el último mes viene dando resultados.

\item Si bien la marca más comprada es Samsung, deberían profundizar en la venta de iPhone, que son los más visitados, pues están de moda por ser considerados de alta gama. Esto no implica no seguir con los modelos de Samsung, simplemente abrir el panorama.

\item Si bien los celulares de 16gb son los más vendidos, prestar atención con los de 32gb, que podrían ser los próximos protagonistas. A aquellos con 8gb, no brindar tanto soporte como antes.

\item La condición “Bueno” sigue siendo la más visitada y comprada, tener esto en cuenta.
Cada mes más usuarios compraron a partir de una campaña, pero como se vió en el análisis, la unica con resultados significativos es la de Google. Por lo tanto, creemos que que debería continuarse con esta modalidad, pero habría que evaluar la relación costo beneficio de las otras campañas publicitarias.

\item Dar soporte especializado al navegador Google Chrome, tanto en su versión de escritorio como en su versión mobile, los otros no son tan significativos a nivel cantidad de usuarios.

\item Por su parte, las tablets están en desuso, por lo tanto, enfocarse en los smartphones principalmente, que van a superar las computadoras de escritorio pronto, en términos de uso.

\item Si bien la mayoría de los usuarios son de Brasil, se noto una creciente actividad en los Estados Unidos. Por lo tanto, una propuesta es traducir la página web al inglés, para promover la visita de personas de dicho país. También notamos un posible negocio futuro en Argentina, donde se debe hacer hincapié en la diferencia de precio con respecto a otros vendedores.  

\item Por último, se debe volver a hacer un análisis de datos en unos meses, y verificar el progreso de la empresa en base a las recomendaciones propuestas, para determinar el correcto camino.

\end{itemize}


\newpage



\begin{thebibliography}{99}
		
	\bibitem{}Trocafone website, \url{www.trocafone.com}.
	
	\bibitem{} NumPy - NumPy, \url{http://www.numpy.org/}.
	
	\bibitem{} Python Data Analysis Library,
	\url{https://pandas.pydata.org/}.
	
	\bibitem{}	Matplotlib: Python plotting — Matplotlib 3.0.0 documentation,
	\url{matplotlib.org}.
	
	
	\bibitem{}seaborn: statistical data visualization — seaborn 0.9.0 documentation,
	\url{seaborn.pydata.org}
	
	\bibitem{} Folium information,
	
	\url{https://github.com/python-visualization/folium}
	
	\bibitem{} GeoPy’s documentation,
	
	\url{
	https://geopy.readthedocs.io/en/stable/}
\end{thebibliography}


\end{document}
